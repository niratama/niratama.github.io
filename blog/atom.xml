<?xml version="1.0" encoding="UTF-8" ?>
<feed xmlns="http://www.w3.org/2005/Atom">
<title>食用ではありません</title>
<link rel="alternate" href="http://nira.poi.jp/blog/" />
<author>こばやし &apos;にらたま&apos; けんいち</author>
<generator uri="https://github.com/Songmu/p5-Riji" version="0.0.11">Perl Riji</generator>
<id>tag:nira.poi.jp,2013-09-22:blog:</id>
<updated>2013-10-20T00:47:12+09:00</updated>
<entry>
<title type="text">続・FreeBSDのportsを一般ユーザー権限でインストールしてみるテスト</title>
<link href="http://nira.poi.jp/blog/entry/2013-10-20-02.html" />
<content><![CDATA[<h1>続・FreeBSDのportsを一般ユーザー権限でインストールしてみるテスト</h1>

<p>とりあえずblog更新して、ああそういえばgitも入ってないんだよな欲しいよな、と早速流用して<code>make</code>してみたところ、</p>

<pre><code>$ make
===&gt; Cannot create , check permissions
*** Error code 1
</code></pre>

<p>おいおい。という訳で再調査。</p>

<p><code>/usr/ports/Mk</code>をこのメッセージで検索したところ、portsのオプション設定のあたりがどうやら原因のようでした。</p>

<p><code>NO_PKG_REGISTER</code>を設定したので<code>/var/db/ports</code>はそのままで無視していたのですが、どうやらオプション設定するあたりで参照しているようなので、これをダミーで設定するようにしてみました。</p>

<pre><code>PORT_DBDIR=${HOME}/var/db/ports
</code></pre>

<p>これを<code>~/ports/ports/ports.userspace.mk</code>に追加することで無事makeが通るようになりました。</p>

<p>パーミッションでエラーで出てたくせに、ディレクトリが存在しなくても問題ないのは謎、というかそこまで追っかけてません。</p>

<p>次に<code>make install</code>すると<code>git_daemon</code>を<code>~/ports/etc/rc.d/</code>に置こうとして失敗するので、あらかじめ、</p>

<pre><code>$ mkdir -p ~/ports/etc/rc.d
</code></pre>

<p>でディレクトリを用意しておきます。(当然<code>git_daemon</code>は使いませんが)</p>

<p>これで無事にgitもインストールできました。</p>

<p>おそらくportsのシステムで参照しているディレクトリをひと通りチェックして対策していれば、こんなにすぐに引っかからなかったんでしょうけど、最低限必要なものが入ればいいだけなので今後も全チェックまではやらないかと。</p>
]]></content>
<id>tag:nira.poi.jp,2013-10-20:blog:entry-2013-10-20-02.html</id>
<published>2013-10-20T40:40:48+0900</published>
<updated>2013-10-20T02:40:48+09:00</updated>
</entry>
<entry>
<title type="text">FreeBSDのportsを一般ユーザー権限でインストールしてみるテスト</title>
<link href="http://nira.poi.jp/blog/entry/2013-10-20-01.html" />
<author>
<name>Kenichi Kobayashi</name>
</author>
<content><![CDATA[<h1>FreeBSDのportsを一般ユーザー権限でインストールしてみるテスト</h1>

<p><strong>※ この記事の作業だけでは動かないportsもあります。詳しくは次の記事を参照してください。</strong></p>

<p>(論理)今日は朝っぱらから<a href="http://www.yokohama-akarenga.jp/oktoberfest2013/">横浜にビールでも飲み</a>に行くか、と思ってたのに、なぜか昔使ってたFreeBSDな環境を気まぐれで再整備してました。</p>

<p>ただviが素のviだったで、とりあえずなんとかしたいなと思ったんだけど、自分の管理してるサーバじゃないのでユーザー権限だけでなんとかできる方法を探してみました。</p>

<ul>
<li><a href="http://quantum-public-diary.blogspot.jp/2012/12/portsfreebsd.html">quantum の記録: portsにあるものを一般ユーザとしてインストールする方法(FreeBSD)</a></li>
</ul>


<p>記事中ちょっと気になったのが、</p>

<blockquote><p>でもinstallは途中でsuをしようとして失敗するので、手で配置する。</p></blockquote>

<p>というところで、あのへんいろいろ細工できるようになってた気がしたので、<code>/usr/ports/Mk/bsd.port.mk</code>を読んでみたら、</p>

<pre><code># INSTALL_AS_USER
#                               - Define this to install as the current user, intended
#                                 for systems where you have no root access.
</code></pre>

<p>なんてのを発見。
あとはシステムのディレクトリ見に行きそうなあたりを回避する目的で<code>NO_PKG_REGISTER</code>とか<code>NO_MTREE</code>あたりを追加してみました。</p>

<p>最終的には以下のような感じ。基本的な流れは元サイトそのままです。</p>

<h3>1. インストール場所の用意、portsの知恵を借りる</h3>

<p>元サイトと配置が違うけど、この辺りはお好みでどうぞ。</p>

<p>vimだけじゃなくて他もインストールする可能性ある気がしたのでこんな感じに。</p>

<pre><code>$ mkdir ~/ports
$ mkdir ~/ports/ports
$ mkdir ~/ports/distfiles
$ cp -r /usr/ports/editors/vim ~/ports/ports/
</code></pre>

<h3>2. Makefileを編集する</h3>

<p>設定を上書きする部分は、あとで他のportsを入れるときにも使いまわせるように、別ファイルにして<code>.include</code>で読み込むようにしてみました。</p>

<pre><code>INSTALL_AS_USER=yes
NO_PKG_REGISTER=yes
NO_MTREE=yes
DISTDIR=${HOME}/ports/ports/distfiles
PREFIX=${HOME}/ports
WRKDIR=/tmp/work
TARGETDIR=${HOME}/ports
</code></pre>

<p>上記の内容で<code>~/ports/ports/ports.userspace.mk</code>というファイルを作成しておいて、<code>~/ports/ports/vim/Makefile</code>の先頭に、</p>

<pre><code>.include "../ports.userspace.mk"
</code></pre>

<p>を追加します。</p>

<h3>3. makeして、installする</h3>

<p>普通にインストールできるようになりました。</p>

<pre><code>$ cd ~/ports/ports/vim/
$ make
$ make install
</code></pre>

<h3>4. 補足</h3>

<p>とりあえずvimに関してはこれで特に問題なかったんですが、その他のportsがこれだけで十分かは不明なので、実際に自分の環境で試してみる場合にはご注意ください。</p>

<p>しかし、vim 7.3のパッチが556個(本家ftp.vim.orgに置いてあるファイルは1,314個)もあって、fetchしてくるときにftpサイトが音を上げてエラーをだしているという……fetchしているときにProtocol errorとか出てても気にしないでください。</p>

<p>これports側でhttpを優先にするかvim.org側である程度の数ごとにtarballにしたほうがいい気が……</p>
]]></content>
<id>tag:nira.poi.jp,2013-10-20:blog:entry-2013-10-20-01.html</id>
<published>2013-10-20T47:47:12+0900</published>
<updated>2013-10-20T00:47:12+09:00</updated>
</entry>
<entry>
<title type="text">YAPC::Asia Tokyo 2013に参加してきました</title>
<link href="http://nira.poi.jp/blog/entry/2013-09-22-03.html" />
<author>
<name>Kenichi Kobayashi</name>
</author>
<content><![CDATA[<h1>YAPC::Asia Tokyo 2013に参加してきました</h1>

<p>という訳で、<a href="http://yapcasia.org/2013/09/yapcasia-2013.html">「ブログを書くまでがYAPC」</a>だそうなので感想エントリを書いてみます。</p>

<h2>会場</h2>

<p>駅からも近くて、会場内の移動が基本フラットだったのが便利でした。</p>

<p>ただ、受付〜メインホール出入口はボトルネックになっていた感じ。
屋台村は通路に設置しないほうが、屋台がみたい人にとっても通路を通るだけの人にとっても良かった気はします。</p>

<p>提灯とか飾ってあってお祭りっぽい雰囲気はなかなか良かったので、次回もうちょっとスペースとってやってもいいかと。</p>

<h2>会場ネットワーク</h2>

<p>一部のアクセスポイントで、繋がっているようにみえてデータが流れない、という状況が発生することがありましたが、 それ以外は快適で非常に助かりました。</p>

<h2>ランチセッション</h2>

<p>お弁当美味しかったですｗ</p>

<h2>トーク</h2>

<p>自分の興味半分、仕事に使えそうなネタ半分で選んだ感じですが、裏で行けなかったトークにも面白そうなのが沢山あって、今回は特にぎりぎりまでどれにするか迷いました。</p>

<p>多目的教室を使う一部のトークが大入りになっていて、イベントホール使っていれば良かったんじゃないか、という気もしました。
このへんは飲食可なのがイベントホールのみ、という事情もあったのかもしれませんが。</p>

<p>あとはトークとトークの間に休憩時間がもう少し欲しかったですね。
わりとトイレもギリギリという感じだったので。</p>

<h2>懇親会</h2>

<p>今回は直後に大人の事情があって1時間弱だけ参加でしたが、食事も話も楽しめました。</p>

<h2>LT</h2>

<p>2日目のLTで時間切り詰めになっても、すごい勢いで発表している様は、まさにLightning。</p>

<h2>(個人的な)トラブル</h2>

<p>1日目いきなり寝坊＋東横線のトラブルでオープニングには間に合わなかったのが痛かった……</p>

<h2>次回以降の話</h2>

<p>今回で牧さんとくしいさんが引退ということで、次回以降どうなるのか予想つかない状態ですが、また1,000人以上集まるような大規模なイベントになることを期待したいです。</p>

<p>自分もLTソンあたり挑戦してみたいですね。</p>
]]></content>
<id>tag:nira.poi.jp,2013-09-22:blog:entry-2013-09-22-03.html</id>
<published>2013-09-22T56:56:07+0900</published>
<updated>2013-09-22T19:56:07+09:00</updated>
</entry>
<entry>
<title type="text">ぶろぐはじめました(n年ぶりm度目)</title>
<link href="http://nira.poi.jp/blog/entry/2013-09-22-01.html" />
<author>
<name>Kenichi Kobayashi</name>
</author>
<content><![CDATA[<h1>ぶろぐはじめました(n年ぶりm度目)</h1>

<p>とりあえずYAPC::Asia Tokyo 2013を終わらせるのにBlogつくってみました。</p>

<p>以前のYAPC::AsiaでBlog書いてないので終わってないんじゃないか、という件については気にしないでください。</p>

<p>Blogつくるにあたってのイロイロは以降のエントリで……</p>
]]></content>
<id>tag:nira.poi.jp,2013-09-22:blog:entry-2013-09-22-01.html</id>
<published>2013-09-22T51:51:17+0900</published>
<updated>2013-09-22T17:51:17+09:00</updated>
</entry>
<entry>
<title type="text">Riji入れてみた</title>
<link href="http://nira.poi.jp/blog/entry/2013-09-22-02.html" />
<author>
<name>Kenichi Kobayashi</name>
</author>
<content><![CDATA[<h1>Riji入れてみた</h1>

<p>ちょうど<a href="http://www.songmu.jp/riji/entry/2013-09-21-yapcasia2013-1.html">YAPC::Asia Tokyo 2013のLTでSongmuさんが紹介</a>していた<a href="https://github.com/Songmu/p5-Riji">Riji</a>を使ってみました。</p>

<p>以下メモと雑感。</p>

<ul>
<li>依存モジュールのインストールに時間かかるなーと思ったら、50個くらいモジュールが追加された。(plenvで入れた、ほぼすっぴん状態のPerlだったから、というのはあるかもしれない)</li>
<li>チュートリアルで言及されていて、TOML(<a href="https://github.com/mojombo/toml">https://github.com/mojombo/toml</a>)ってのがあるのを知った。ぱっと見はデータ構造つきで階層化できるiniファイルっぽい印象。</li>
<li>いままでwget入れてなかったのに気がついた。普段curl使ってて困ってなかったし。でもソースざっと眺めてみた感じだとwget使ってないような？</li>
<li>GitHub Pages+独自ドメインで使ってみた。<a href="http://songmu.github.io/p5-Riji/blog/entry/003_publish.html">チュートリアル003</a>と<a href="https://help.github.com/categories/20/articles">GitHub PagesのHelp</a>を参考に。

<ul>
<li>User Pagesの場合、gh-pagesブランチじゃなくてmasterブランチのファイルを参照するので、riji.ymlへの設定の追加とgh-pagesブランチへの切り替えは不要</li>
<li>User Pages用のリポジトリ名の規則は決まっている(username.github.ioというリポジトリを作る)</li>
<li>CNAMEというファイルをリポジトリのルートに置いて、使うドメイン名を書く</li>
<li>使うドメインをCNAME使ってusername.github.ioに向ける。CNAME使えない場合は指定のIPアドレスに。</li>
</ul>
</li>
<li><a href="http://songmu.github.io/p5-Riji/blog/entry/002_edit.html">チュートリアル002</a>のとおりにサンプル削除してそのままcommitしてしまうと、entryディレクトリが消えてしまうので、.gitignoreとか.gitkeepとか置いておくと吉かもしれない。あとriji new-entryはentryディレクトリ消えてるとエラーでコケる。</li>
<li>riji server -R articleでファイル更新に追従してくれる。(メモってなかったけど発表のデモでやってた気がする)</li>
<li>デフォルトのテンプレートで使ってるBootstrapは3.0.0-rc1だったけど、既に3.0.0出てたのでテンプレート修正時についでに変更。</li>
<li>とりあえずTwitterのWidgetくらいはくっつけてみた。</li>
<li>コメントはどうしよう？</li>
</ul>


<p>実際エントリ書きよりもテンプレート修正とGitHub Pages関係(User Pagesなのにgh-pages作ったりしてハマった)のほうに時間がかかった気がします。</p>

<p>せっかく作ったので、こまめに更新できたらなぁ、と。</p>
]]></content>
<id>tag:nira.poi.jp,2013-09-22:blog:entry-2013-09-22-02.html</id>
<published>2013-09-22T51:51:17+0900</published>
<updated>2013-09-22T17:51:17+09:00</updated>
</entry>
</feed>
